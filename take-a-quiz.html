<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Take a quiz</title>
  <link rel="stylesheet" href="navbar.css">
  <link rel="stylesheet" href="general.css">
  <link rel="stylesheet" href="cards.css">
</head>
<body>
  <ul class="topnav">
    <li><a href="index.html">Home</a></li>
    <li><a href="add-question.html">Add questions</a></li>
    <li><a class="active" href="make-a-quiz.html">Create a quiz</a></li>
    <li><a href="take-a-quiz.html">Take a quiz</a></li>
    <li class="right"><a href="#about">About</a></li>
  </ul>

  <div id="quizContainer" class="container" style="display: none;">

    <form id="quizForm">
      <button id="prevButton" onclick="showQuestion(-1)" style="display: none;">
      <button id="nextButton" onclick="showQuestion(1)">
    </form>
    <p id="score" style="display: none;"></p>
  </div>
  

<div id="list" class="cards"></div>

<body>
  <script>
    let host = "http://localhost:8080";
    let questions = [];
    let currentQuestion = 0;

    async function getAll() {
        let response = await fetch(host + "/quizzes");
        return await response.json();
      }

      async function displayTheQuizzes() {
        questions = await getAll();

        let list = document.getElementById("list");
        list.innerHTML = "";

        for (let question of questions) {
          let div = document.createElement("div");
          div.className = "card";
          let innerHtml = `
         
          <img src="http://localhost:8080/quizzes/" alt="quiz" style="width:100%">
          <div class="container">
            <h4><b>${quiz.id}</b></h4> 
            <p>${quiz.description}</p>
            <h4><b>${quizzes.size}</b></h4> 
          </div>
      
              `;
            div.innerHTML = innerHtml;
            list.addEventListener("click", () => takeQuiz(quiz));
        }
      }

      function takeQuiz(quiz) {
        document.getElementById("list").style.display = "none";
        document.getElementById("quizContainer").style.display = "block";
        currentQuestion = 0;
        showQuestion(0);
      }

      function showQuestion(index) {
        currentQuestion += index;
        if(currentQuestion < 0) {
          currentQuestion = 0;
        }
        let questionText = document.getElementById("questionText");
        let prevButton = document.getElementById("prevButton");
        let nextButton = document.getElementById("nextButton");
        let scoreText = document.getElementById("score");

        if(currentQuestion >= quiz.questions.size) {
          scoreText.textContent = "You scored ___ out of ___";
          scoreText.style.display = "block"
        }

        questionText.textContent = quiz.questions[index];

        if(index == 0) {
          prevButton.style.display = "none";
        } else {
          prevButton.style.display = "block";
        }
      }

      function next() {
        currentQuestion++;
        showQuestion(currentQuestion);
      }

      function previous() {
        currentQuestion--;
        showQuestion(currentQuestion);
      }
  </script>
  
</body>
</html>